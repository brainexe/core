<?xml version="1.0" encoding="utf-8"?>
<container xmlns="http://symfony.com/schema/dic/services" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">
	<parameters>
		<parameter key="debug">false</parameter>

		<parameter key="db.host">127.0.0.1</parameter>
		<parameter key="db.system">mysql</parameter>
		<parameter key="db.database">raspberry</parameter>
		<parameter key="db.user">root</parameter>
		<parameter key="db.password"/>
		<parameter key="timezone">Europe/Berlin</parameter>

		<parameter key="redis.host">127.0.0.1</parameter>

		<parameter key="cache.dir">%application.root%/cache/</parameter>
		<parameter key="logger.dir">%application.root%/logs/</parameter>
		<parameter key="logger.error.log">%logger.dir%error.log</parameter>
		<parameter key="logger.info.log">%logger.dir%info.log</parameter>

		<parameter key="application.name" on-invalid="exception"/>
	</parameters>

    <services>
        <service id="pdo" class="PDO" public="false">
            <argument>%db.system%:host=%db.host%;dbname=%db.database%</argument>
            <argument>%db.user%</argument>
            <argument>%db.password%</argument>
            <argument type="collection">
                <argument key="1002">SET NAMES utf8</argument>
            </argument>
        </service>

        <service id="predis" class="Predis\Client" public="false">
            <argument type="collection">
                <argument key="read_write_timeout">0</argument>
                <argument key="host">%redis.host%</argument>
                <argument key="prefix">%application.name%:</argument>
            </argument>
        </service>

        <service id="monolog.logger" class="Monolog\Logger">
            <argument>%application.name%</argument>
			<call method="pushHandler">
				<argument type="service" id="monolog.ErrorLog"/>
			</call>
        </service>
        <service id="monolog.ErrorLog" class="Monolog\Handler\StreamHandler" public="false">
            <argument>%logger.error.log%</argument>
            <argument type="constant">Monolog\Logger::DEBUG</argument>
        </service>

		<service id="EventDispatcher" class="Symfony\Component\EventDispatcher\EventDispatcher" public="false">
		</service>

		<service id="Application" class="Silex\Application">
			<argument type="collection">
				<argument key="debug">%debug%</argument>
			</argument>

			<call method="register">
				<argument type="service">
					<service class="Silex\Provider\TwigServiceProvider"/>
				</argument>
				<argument type="collection">
					<argument key="twig.path">templates</argument>
					<argument key="twig.options" type="collection">
						<argument key="cache">%cache.dir%twig</argument>
					</argument>
				</argument>
			</call>
			<call method="register">
				<argument type="service">
					<service class="Silex\Provider\SessionServiceProvider"/>
				</argument>
			</call>
		</service>

		<service id="Console" class="Symfony\Component\Console\Application">
			<call method="setAutoExit">
				<argument>false</argument>
			</call>
		</service>
    </services>
</container>
